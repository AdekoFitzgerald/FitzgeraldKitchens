
(setq cixBiesse_HoleCamOperation nil)
(defun cixBiesse_HoleCamOperation (currentEnt entLayerName tempCAMStyle currentPanel cixfile / tempHolePos mHoleDia tempHoleDepth
																								mHoleX mHoleY mHoleDepth mHoleDia
																								ikiyuzon tempHolePosWorld 
																								tempPanelDepth tempPanelLength tempPanelWidth
																								sideOrigin tempHolePosSide holeDepthLimit tempHoleDia)
	
	; Also see bsuid help - Creating and naming standard panel faces 
	;			4 icin sað üst org	   	
	;  					4
	;				|---------|
	;				|         |
	;	sol üst 1	|    0    |  3 sað alt
	;				|         |
	;				|*________|
	;					2
	;			2 icin origin 0 gibi
	
	(setq tempHolePos (getEntPro currentEnt 10))
	(setq tempHoleDia (lmm_getLMMdata currentEnt lmm-k-diameter))
	(setq tempHoleDepth (lmm_getLMMdata currentEnt lmm-k-depth))
	(setq holeDepthLimit 28)
	(cond
		((equal "TOP" (substr entLayerName 1 3)); top hole routines
			;(setq tempPanelWidth (getnth 3 (getBBox currentPanel)))
			;(setq sideOrigin (list 0.0 (* -1 tempPanelWidth) 0.0))
			;(setq tempHolePos (vectorsub tempHolePos sideOrigin))
			(setq tempPanelWidth (getnth 3 (getBBox currentPanel)))
			(setq mHoleX (lmm_convertNumtoStringWithDigit (abs (getnth 0 tempHolePos)) 2))
			(setq mHoleY (lmm_convertNumtoStringWithDigit (- tempPanelWidth (abs(getnth 1 tempHolePos))) 2))
			(setq mHoleDepth (lmm_convertNumtoStringWithDigit (abs tempHoleDepth) 2))
			(setq mHoleDia (lmm_convertNumtoStringWithDigit (abs tempHoleDia) 2))
			(princ "\n\nBEGIN MACRO" cixfile)
			(princ "\n\tNAME=BG" cixfile)
			(princ "\n\tPARAM,NAME=SIDE,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=CRN,VALUE=\"1\"" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=X,VALUE=~s"(_ mHoleX)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=Y,VALUE=~s" (_ mHoleY)) cixfile)
			(princ "\n\tPARAM,NAME=Z,VALUE=0" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DP,VALUE=~s" (_ mHoleDepth)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DIA,VALUE=~s" (_ mHoleDia)) cixfile)
			(princ "\n\tPARAM,NAME=THR,VALUE=NO" cixfile)
			(setq CIXPROGRAMID (1+ CIXPROGRAMID))
			(princ (sprintf  "\n\tPARAM,NAME=Id,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0))) cixfile)
			(princ "\n\tPARAM,NAME=TTP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=WSP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"BG\"" cixfile)
			
			(if (not (equal "" (nth 1 tempCAMStyle)))
				(progn
					(princ "\n\tPARAM,NAME=RTY,VALUE=rpNO" cixFile)
					(princ "\n\tPARAM,NAME=DX,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=DY,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=R,VALUE=50" cixFile)
					(princ "\n\tPARAM,NAME=A,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DA,VALUE=45" cixFile)
					(princ "\n\tPARAM,NAME=NRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ISO,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=OPT,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=AZ,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AP,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CKA,VALUE=azrNO" cixFile)
					(princ "\n\tPARAM,NAME=XRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=YRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ARP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=LRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ER,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=MD,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=COW,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=A21,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=TOS,VALUE=NO" cixFile)
					(if (and (or (> tempHoleDia 30) (< tempHoleDia 5.0)) (> tempHoleDepth 10))
						(princ "\n\tPARAM,NAME=VTR,VALUE=4" cixFile)
						(princ "\n\tPARAM,NAME=VTR,VALUE=0" cixFile)
					)
					(princ "\n\tPARAM,NAME=S21,VALUE=-1" cixFile)
					(princ "\n\tPARAM,NAME=AZS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=MAC,VALUE=\"\"" cixFile)
					(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ (nth 1 tempCAMStyle))) cixFile)
					(princ "\n\tPARAM,NAME=TCL,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=RSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=IOS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=DDS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=BFC,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=SHP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=EA21,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CEN,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=AGG,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=PRS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=ETB,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=KDT,VALUE=NO" cixFile)
				)
			)
			
			;(if (not (equal "" (nth 3 tempCAMStyle)))
			;	(progn
			;		 ;0 - Normal,1 - Baþlat, 2 - Havþa baþlý, 3 - NormalG
 			;		(cond
			;			((equal "NORMAL" (nth 3 tempCAMStyle))
			;				(princ "\n\tPARAM,NAME=TTY,VALUE=0" cixFile)
			;			)
			;			((equal "BASLAT" (nth 3 tempCAMStyle))
			;				(princ "\n\tPARAM,NAME=TTY,VALUE=1" cixFile)
			;			)
			;			((equal "HAVSABASLI" (nth 3 tempCAMStyle))
			;				(princ "\n\tPARAM,NAME=TTY,VALUE=2" cixFile)
			;			)
			;			((equal "NORMALG" (nth 3 tempCAMStyle))
			;				(princ "\n\tPARAM,NAME=TTY,VALUE=3" cixFile)
			;			)
			;		)
			;	)
			;)
			
			
			(princ "\nEND MACRO" cixfile)
		)
		((equal "RIG" (substr entLayerName 1 3)); right hole routines
			(setq ikiyuzon (getEntPro tempEnt 210))
			(setq tempHolePosWorld (trans tempHolePos ikiyuzon 0))
			(setq tempPanelDepth (lmm_getLMMdata currentPanel lmm-k-depth))
			(setq tempPanelLength (getnth 2 (getBBox currentPanel)))
			(setq tempPanelWidth (getnth 3 (getBBox currentPanel)))
			(setq sideOrigin (list tempPanelLength 0.0 (* -1 tempPanelDepth)))
			(setq tempHolePosSide (vectorsub tempHolePosWorld sideOrigin))
			(setq tempHolePos (list (nth 1 tempHolePosSide) (nth 2 tempHolePosSide) 0.0 ))
			(setq mHoleX (lmm_convertNumtoStringWithDigit (getnth 0 tempHolePos) 2))
			(setq mHoleY (lmm_convertNumtoStringWithDigit  (getnth 1 tempHolePos) 2))
			(if (> (abs tempHoleDepth) 28)
				(setq mHoleDepth (lmm_convertNumtoStringWithDigit holeDepthLimit 2))
				(setq mHoleDepth (lmm_convertNumtoStringWithDigit (abs tempHoleDepth) 2))
			)
			(setq mHoleDia (lmm_convertNumtoStringWithDigit (abs tempHoleDia) 2))
			(princ "\n\nBEGIN MACRO" cixfile)
			(princ "\n\tNAME=BG" cixfile)
			(princ "\n\tPARAM,NAME=SIDE,VALUE=3" cixfile)
			(princ "\n\tPARAM,NAME=CRN,VALUE=\"2\"" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=X,VALUE=~s"(_ mHoleX)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=Y,VALUE=~s" (_ mHoleY)) cixfile)
			(princ "\n\tPARAM,NAME=Z,VALUE=0" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DP,VALUE=~s" (_ mHoleDepth)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DIA,VALUE=~s" (_ mHoleDia)) cixfile)
			(princ "\n\tPARAM,NAME=THR,VALUE=NO" cixfile)
			(setq CIXPROGRAMID (1+ CIXPROGRAMID))
			(princ (sprintf  "\n\tPARAM,NAME=Id,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0))) cixfile)
			(princ "\n\tPARAM,NAME=TTP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=WSP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"BG\"" cixfile)
			(if (not (equal "" (nth 1 tempCAMStyle)))
				(progn
					(princ "\n\tPARAM,NAME=RTY,VALUE=rpNO" cixFile)
					(princ "\n\tPARAM,NAME=DX,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=DY,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=R,VALUE=50" cixFile)
					(princ "\n\tPARAM,NAME=A,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DA,VALUE=45" cixFile)
					(princ "\n\tPARAM,NAME=NRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ISO,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=OPT,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=AZ,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AP,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CKA,VALUE=azrNO" cixFile)
					(princ "\n\tPARAM,NAME=XRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=YRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ARP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=LRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ER,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=MD,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=COW,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=A21,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=TOS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=VTR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=S21,VALUE=-1" cixFile)
					(princ "\n\tPARAM,NAME=AZS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=MAC,VALUE=\"\"" cixFile)
					(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ (nth 1 tempCAMStyle))) cixFile)
					(princ "\n\tPARAM,NAME=TCL,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=RSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=IOS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=DDS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=BFC,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=SHP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=EA21,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CEN,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=AGG,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=PRS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=ETB,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=KDT,VALUE=NO" cixFile)
				)
			)
			(princ "\nEND MACRO" cixfile)
		)
		((equal "LEF" (substr entLayerName 1 3)); left hole routines
			(setq ikiyuzon (getEntPro tempEnt 210))
			(setq tempHolePosWorld (trans tempHolePos ikiyuzon 0))
			(setq tempPanelDepth (lmm_getLMMdata currentPanel lmm-k-depth))
			(setq tempPanelLength (getnth 2 (getBBox currentPanel)))
			(setq tempPanelWidth (getnth 3 (getBBox currentPanel)))
			(setq sideOrigin (list tempPanelLength 0.0 0.0))
			(setq tempHolePosSide (vectorsub tempHolePosWorld sideOrigin))
			(setq tempHolePos (list (- tempPanelWidth (nth 1 tempHolePosSide)) (nth 2 tempHolePosSide) 0 ))
			(setq mHoleX (lmm_convertNumtoStringWithDigit (getnth 0 tempHolePos) 2))
			(setq mHoleY (lmm_convertNumtoStringWithDigit (abs (getnth 1 tempHolePos)) 2))
			(if (> (abs tempHoleDepth) 28)
				(setq mHoleDepth (lmm_convertNumtoStringWithDigit holeDepthLimit 2))
				(setq mHoleDepth (lmm_convertNumtoStringWithDigit (abs tempHoleDepth) 2))
			)
			(setq mHoleDia (lmm_convertNumtoStringWithDigit (abs tempHoleDia) 2))
			(princ "\n\nBEGIN MACRO" cixfile)
			(princ "\n\tNAME=BG" cixfile)
			(princ "\n\tPARAM,NAME=SIDE,VALUE=1" cixfile)
			(princ "\n\tPARAM,NAME=CRN,VALUE=\"1\"" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=X,VALUE=~s"(_ mHoleX)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=Y,VALUE=~s" (_ mHoleY)) cixfile)
			(princ "\n\tPARAM,NAME=Z,VALUE=0" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DP,VALUE=~s" (_ mHoleDepth)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DIA,VALUE=~s" (_ mHoleDia)) cixfile)
			(princ "\n\tPARAM,NAME=THR,VALUE=NO" cixfile)
			(setq CIXPROGRAMID (1+ CIXPROGRAMID))
			(princ (sprintf  "\n\tPARAM,NAME=Id,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0))) cixfile)
			(princ "\n\tPARAM,NAME=TTP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=WSP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"BG\"" cixfile)
			(if (not (equal "" (nth 1 tempCAMStyle)))
				(progn
					(princ "\n\tPARAM,NAME=RTY,VALUE=rpNO" cixFile)
					(princ "\n\tPARAM,NAME=DX,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=DY,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=R,VALUE=50" cixFile)
					(princ "\n\tPARAM,NAME=A,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DA,VALUE=45" cixFile)
					(princ "\n\tPARAM,NAME=NRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ISO,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=OPT,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=AZ,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AP,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CKA,VALUE=azrNO" cixFile)
					(princ "\n\tPARAM,NAME=XRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=YRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ARP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=LRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ER,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=MD,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=COW,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=A21,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=TOS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=VTR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=S21,VALUE=-1" cixFile)
					(princ "\n\tPARAM,NAME=AZS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=MAC,VALUE=\"\"" cixFile)
					(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ (nth 1 tempCAMStyle))) cixFile)
					(princ "\n\tPARAM,NAME=TCL,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=RSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=IOS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=DDS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=BFC,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=SHP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=EA21,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CEN,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=AGG,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=PRS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=ETB,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=KDT,VALUE=NO" cixFile)
				)
			)
			(princ "\nEND MACRO" cixfile)
		)
		((equal "REA" (substr entLayerName 1 3)); rear hole routines
			(setq ikiyuzon (getEntPro tempEnt 210))
			(setq tempHolePosWorld (trans tempHolePos ikiyuzon 0))
			(setq tempPanelDepth (lmm_getLMMdata currentPanel lmm-k-depth))
			(setq tempPanelLength (getnth 2 (getBBox currentPanel)))
			(setq tempPanelWidth (getnth 3 (getBBox currentPanel)))
			(setq sideOrigin (list tempPanelLength tempPanelWidth 0.0))
			(setq tempHolePosSide (vectorsub tempHolePosWorld sideOrigin))
			(setq tempHolePos (list (nth 0 tempHolePosSide) (nth 2 tempHolePosSide) 0.0 ))
			(setq mHoleX (lmm_convertNumtoStringWithDigit (abs (getnth 0 tempHolePos)) 2))
			(setq mHoleY (lmm_convertNumtoStringWithDigit (abs(getnth 1 tempHolePos)) 2))
			(if (> (abs tempHoleDepth) 28)
				(setq mHoleDepth (lmm_convertNumtoStringWithDigit holeDepthLimit 2))
				(setq mHoleDepth (lmm_convertNumtoStringWithDigit (abs tempHoleDepth) 2))
			)
			(setq mHoleDia (lmm_convertNumtoStringWithDigit (abs tempHoleDia) 2))
			(princ "\n\nBEGIN MACRO" cixfile)
			(princ "\n\tNAME=BG" cixfile)
			(princ "\n\tPARAM,NAME=SIDE,VALUE=4" cixfile)
			(princ "\n\tPARAM,NAME=CRN,VALUE=\"1\"" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=X,VALUE=~s"(_ mHoleX)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=Y,VALUE=~s" (_ mHoleY)) cixfile)
			(princ "\n\tPARAM,NAME=Z,VALUE=0" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DP,VALUE=~s" (_ mHoleDepth)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DIA,VALUE=~s" (_ mHoleDia)) cixfile)
			(princ "\n\tPARAM,NAME=THR,VALUE=NO" cixfile)
			(setq CIXPROGRAMID (1+ CIXPROGRAMID))
			(princ (sprintf  "\n\tPARAM,NAME=Id,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0))) cixfile)
			(princ "\n\tPARAM,NAME=TTP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=WSP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"BG\"" cixfile)
			(if (not (equal "" (nth 1 tempCAMStyle)))
				(progn
					(princ "\n\tPARAM,NAME=RTY,VALUE=rpNO" cixFile)
					(princ "\n\tPARAM,NAME=DX,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=DY,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=R,VALUE=50" cixFile)
					(princ "\n\tPARAM,NAME=A,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DA,VALUE=45" cixFile)
					(princ "\n\tPARAM,NAME=NRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ISO,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=OPT,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=AZ,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AP,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CKA,VALUE=azrNO" cixFile)
					(princ "\n\tPARAM,NAME=XRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=YRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ARP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=LRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ER,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=MD,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=COW,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=A21,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=TOS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=VTR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=S21,VALUE=-1" cixFile)
					(princ "\n\tPARAM,NAME=AZS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=MAC,VALUE=\"\"" cixFile)
					(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ (nth 1 tempCAMStyle))) cixFile)
					(princ "\n\tPARAM,NAME=TCL,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=RSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=IOS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=DDS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=BFC,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=SHP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=EA21,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CEN,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=AGG,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=PRS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=ETB,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=KDT,VALUE=NO" cixFile)
				)
			)
			(princ "\nEND MACRO" cixfile)
		)
		((equal "FRO" (substr entLayerName 1 3)); front hole routines
			(setq ikiyuzon (getEntPro tempEnt 210))
			(setq tempHolePosWorld (trans tempHolePos ikiyuzon 0))
			(setq tempPanelDepth (lmm_getLMMdata currentPanel lmm-k-depth))
			(setq tempPanelLength (getnth 2 (getBBox currentPanel)))
			(setq tempPanelWidth (getnth 3 (getBBox currentPanel)))
			(setq sideOrigin (list 0.0 0.0 0.0))
			(setq tempHolePosSide (vectorsub tempHolePosWorld sideOrigin))
			(setq tempHolePos (list (nth 0 tempHolePosSide) (nth 2 tempHolePosSide) 0.0 ))
			(setq mHoleX (lmm_convertNumtoStringWithDigit (abs (getnth 0 tempHolePos)) 2))
			(setq mHoleY (lmm_convertNumtoStringWithDigit (abs(getnth 1 tempHolePos)) 2))
			(if (> (abs tempHoleDepth) 28)
				(setq mHoleDepth (lmm_convertNumtoStringWithDigit holeDepthLimit 2))
				(setq mHoleDepth (lmm_convertNumtoStringWithDigit (abs tempHoleDepth) 2))
			)
			(setq mHoleDia (lmm_convertNumtoStringWithDigit (abs tempHoleDia) 2))
			(princ "\n\nBEGIN MACRO" cixfile)
			(princ "\n\tNAME=BG" cixfile)
			(princ "\n\tPARAM,NAME=SIDE,VALUE=2" cixfile)
			(princ "\n\tPARAM,NAME=CRN,VALUE=\"1\"" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=X,VALUE=~s"(_ mHoleX)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=Y,VALUE=~s" (_ mHoleY)) cixfile)
			(princ "\n\tPARAM,NAME=Z,VALUE=0" cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DP,VALUE=~s" (_ mHoleDepth)) cixfile)
			(princ (sprintf  "\n\tPARAM,NAME=DIA,VALUE=~s" (_ mHoleDia)) cixfile)
			(princ "\n\tPARAM,NAME=THR,VALUE=NO" cixfile)
			(setq CIXPROGRAMID (1+ CIXPROGRAMID))
			(princ (sprintf  "\n\tPARAM,NAME=Id,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0))) cixfile)
			(princ "\n\tPARAM,NAME=TTP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=WSP,VALUE=0" cixfile)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"BG\"" cixfile)
			(if (not (equal "" (nth 1 tempCAMStyle)))
				(progn
					(princ "\n\tPARAM,NAME=RTY,VALUE=rpNO" cixFile)
					(princ "\n\tPARAM,NAME=DX,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=DY,VALUE=32" cixFile)
					(princ "\n\tPARAM,NAME=R,VALUE=50" cixFile)
					(princ "\n\tPARAM,NAME=A,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DA,VALUE=45" cixFile)
					(princ "\n\tPARAM,NAME=NRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ISO,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=OPT,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=AZ,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=AP,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CKA,VALUE=azrNO" cixFile)
					(princ "\n\tPARAM,NAME=XRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=YRC,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ARP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=LRP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=ER,VALUE=YES" cixFile)
					(princ "\n\tPARAM,NAME=MD,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=COW,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=A21,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=TOS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=VTR,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=S21,VALUE=-1" cixFile)
					(princ "\n\tPARAM,NAME=AZS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=MAC,VALUE=\"\"" cixFile)
					(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ (nth 1 tempCAMStyle))) cixFile)
					(princ "\n\tPARAM,NAME=TCL,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=RSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=IOS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=DDS,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=DSP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=BFC,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=SHP,VALUE=0" cixFile)
					(princ "\n\tPARAM,NAME=EA21,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=CEN,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=AGG,VALUE=\"\"" cixFile)
					(princ "\n\tPARAM,NAME=PRS,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=ETB,VALUE=NO" cixFile)
					(princ "\n\tPARAM,NAME=KDT,VALUE=NO" cixFile)
				)
			)
			(princ "\nEND MACRO" cixfile)
		)
		((equal "BOT" (substr entLayerName 1 3)); bottom hole routines
			(princ "\n\n------>>>> Bottom delik uyarýsý>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>")
		)
	)
	
)


(defun cixBiesse_SAWCAMOperation (currentEnt entLayerName tempCAMStyle currentPanel file / polylineIsStraitAlongByXAxis tempPoints tempPoint 
																							startPoint endPoint tempEndPoint tempToolName tempDepth
																							tempPanelWidth )
	(setq polylineIsStraitAlongByXAxis T)
	(setq tempPoints (lmm_getPolylinePoints currentEnt))
	(setq startPoint (nth 0 tempPoints))
	(foreach tempPoint tempPoints ;SAW blade can cut only x direction. so we must check whether given polyline is suitable to cut or not.
		(if (not (equal (nth 1 startPoint) (nth 1 tempPoint) 6))
			(progn
				(setq polylineIsStraitAlongByXAxis nil)
			)
		)
	)
	(if polylineIsStraitAlongByXAxis 
		(progn
			(setq tempToolName (cadr tempCAMStyle))
			(setq tempDepth (lmm_getLMMdata currentEnt lmm-k-depth))
			(setq tempDepth (+ tempDepth (nth 6 tempCAMStyle)))
			(setq tempPanelWidth (getnth 3 (getBBox currentPanel)))
			
			(setq endPoint (last tempPoints))
			(if (> (nth 0 startPoint) (nth 0 endpoint))
				(progn
					(setq tempEndPoint endPoint)
					(setq endPoint startPoint)
					(setq startPoint tempEndPoint)
				)
			)
			(cond 
				( (equal "CENTER" (nth 7 tempCAMStyle))
					(setq tempPoints (list startPoint endPoint))
				)
				( (equal "INSIDE" (nth 7 tempCAMStyle))
					(setq startPoint (VectorAdd startPoint (list 0 (* (nth 8 tempCAMStyle) -1) 0) ))
					(setq endPoint (VectorAdd endPoint (list 0 (* (nth 8 tempCAMStyle) -1) 0) ))
					(setq tempPoints (list startPoint endPoint))
				)
				( (equal "OUTSIDE" (nth 7 tempCAMStyle))
					(setq startPoint (VectorAdd startPoint (list 0 (nth 8 tempCAMStyle) 0) ))
					(setq endPoint (VectorAdd endPoint (list 0 (nth 8 tempCAMStyle) 0) ))
					(setq tempPoints (list startPoint endPoint))
				)
			)
			
			(princ "\n\nBEGIN MACRO" file)
			(princ "\n\tNAME=GEO" file)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" file)
			(setq CIXGEOMETRYID (1+ CIXGEOMETRYID))
			(princ (sprintf "\n\tPARAM,NAME=ID,VALUE=\"G1001.~s\"" (_ (lmm_convertNumtoStringWithDigit CIXGEOMETRYID 0))) file)
			(princ "\n\tPARAM,NAME=SIDE,VALUE=0" file)
			(princ "\n\tPARAM,NAME=CRN,VALUE=\"1\"" file)
			(princ "\n\tPARAM,NAME=DP,VALUE=0" file)
			(princ "\n\tPARAM,NAME=RTY,VALUE=2" file)
			(princ "\n\tPARAM,NAME=NRP,VALUE=0" file)
			(princ "\n\tPARAM,NAME=DX,VALUE=0" file)
			(princ "\n\tPARAM,NAME=DY,VALUE=0" file)
			(princ "\n\tPARAM,NAME=RV,VALUE=0" file)
			(princ "\n\tPARAM,NAME=COW,VALUE=0" file)
			(princ "\n\tPARAM,NAME=CRC,VALUE=0" file)
			(princ "\nEND MACRO" file)
	
			(princ "\n\nBEGIN MACRO" file)
			(princ "\n\tNAME=START_POINT" file)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" file)
			(princ (sprintf "\n\tPARAM,NAME=X,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit (car startPoint) 2)) ) file)
			(princ (sprintf "\n\tPARAM,NAME=Y,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit (- tempPanelWidth (cadr startPoint)) 2)) ) file)
			(princ "\nEND MACRO" file)
			
			(princ "\n\nBEGIN MACRO" file)
			(princ "\n\tNAME=LINE_EP" file)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" file)
			(princ (sprintf "\n\tPARAM,NAME=XE,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit (car endPoint) 2)) ) file)
			(princ (sprintf "\n\tPARAM,NAME=YE,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit (- tempPanelWidth (cadr endPoint)) 2)) ) file)
			(princ "\n\tPARAM,NAME=FD,VALUE=0" file)
			(princ "\n\tPARAM,NAME=SP,VALUE=0" file)
			(princ "\n\tPARAM,NAME=ZS,VALUE=0" file)
			(princ "\n\tPARAM,NAME=ZE,VALUE=0" file)
			(princ "\nEND MACRO" file)
			
			(princ "\n\nBEGIN MACRO" file)
			(princ "\n\tNAME=ENDPATH" file)
			(princ "\nEND MACRO" file)
			
			
			(princ "\n\nBEGIN MACRO" file)
			(princ "\n\tNAME=CUT_GEO" file)
			(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" file)
			(setq CIXPROGRAMID (1+ CIXPROGRAMID))
			(princ (sprintf "\n\tPARAM,NAME=ID,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0)))file) ; comes from program ýd
			(princ (sprintf "\n\tPARAM,NAME=GID,VALUE=\"G1001.~s\"" (_ (lmm_convertNumtoStringWithDigit CIXGEOMETRYID 0))) file) ; comes from geometri id
			(princ "\n\tPARAM,NAME=SIL,VALUE=\"\"" file)
			(princ "\n\tPARAM,NAME=Z,VALUE=0" file)
			(princ (sprintf "\n\tPARAM,NAME=DP,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempDepth 2)) ) file)
			(princ "\n\tPARAM,NAME=TH,VALUE=0" file)
			(princ "\n\tPARAM,NAME=THR,VALUE=0" file)
			(princ "\n\tPARAM,NAME=TTK,VALUE=0" file)
			(princ "\n\tPARAM,NAME=CRC,VALUE=0" file)
			(princ "\n\tPARAM,NAME=RV,VALUE=0" file)
			(princ "\n\tPARAM,NAME=CKA,VALUE=2" file)
			(princ "\n\tPARAM,NAME=AZ,VALUE=0" file)
			(princ "\n\tPARAM,NAME=OPT,VALUE=1" file)
			(princ "\n\tPARAM,NAME=RSP,VALUE=6000" file)
			(princ "\n\tPARAM,NAME=IOS,VALUE=0" file)
			(princ "\n\tPARAM,NAME=WSP,VALUE=8000" file)
			(princ "\n\tPARAM,NAME=DSP,VALUE=5000" file)
			(princ "\n\tPARAM,NAME=OVM,VALUE=0" file)
			(princ "\n\tPARAM,NAME=DIN,VALUE=0" file)
			(princ "\n\tPARAM,NAME=DOU,VALUE=0" file)
			(princ "\n\tPARAM,NAME=TOS,VALUE=1" file)
			(princ "\n\tPARAM,NAME=VTR,VALUE=1" file)
			(princ "\n\tPARAM,NAME=GIP,VALUE=1" file)
			(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ tempToolName)) file) ; comes from tools name
			(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" file)
			(princ "\n\tPARAM,NAME=BFC,VALUE=0" file)
			(princ "\n\tPARAM,NAME=SHP,VALUE=0" file)
			(princ "\n\tPARAM,NAME=BRC,VALUE=0" file)
			(princ "\n\tPARAM,NAME=BDR,VALUE=0" file)
			(princ "\n\tPARAM,NAME=PRV,VALUE=1" file)
			(princ "\n\tPARAM,NAME=NRV,VALUE=0" file)
			(princ "\n\tPARAM,NAME=DVR,VALUE=0" file)
			(princ "\n\tPARAM,NAME=KDT,VALUE=0" file)
			(princ "\nEND MACRO" file)
		
		)
		(progn
			(alert "SAW operation can not applied.\nThe direction of geometry is not in the x-axis direction.")
		)
	)
)

(setq cixBiesse_ContourCAMOperation nil)
(defun cixBiesse_ContourCAMOperation (currentEnt entLayerName tempCAMStyle currentPanel file / tempDepth tempToolName toolCorrection)
	(setq tempDepth (lmm_getLMMdata currentEnt lmm-k-depth))
	(setq tempDepth (+ tempDepth (nth 6 tempCAMStyle)))
	(setq tempToolName (cadr tempCAMStyle))
	
	;To define toolCorrection final result must be switch . Because Biesse Y coordinate values are inverted. 
	;info: GetIrregularPointlistClockwiseOrder adds extra closest point for a single line to determine clock order. 
	(cond
		( (equal "CENTER" (nth 7 tempCAMStyle)) 
			(setq toolCorrection "0")
		)		
		( (equal "INSIDE" (nth 7 tempCAMStyle))
			(setq tempPoints (lmm_getPolylinePoints currentEnt))
			(if (equal "CCW" (GetIrregularPointlistClockwiseOrder_2 tempPoints currentPanel (nth 11 tempCAMStyle)))
				(setq toolCorrection "1")
				(setq toolCorrection "2")
			)
		)
		( (equal "OUTSIDE" (nth 7 tempCAMStyle))
			(setq tempPoints (lmm_getPolylinePoints currentEnt))
			(if (equal "CCW" (GetIrregularPointlistClockwiseOrder_2 tempPoints currentPanel (nth 11 tempCAMStyle)))
				(setq toolCorrection "2")
				(setq toolCorrection "1")
			)
		)
	)
	
	(drawCixGeometry currentPanel currentEnt file)
	
	(princ "\n\nBEGIN MACRO" file)
	(princ "\n\tNAME=ROUTG" file)
	(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" file)
	(setq CIXPROGRAMID (1+ CIXPROGRAMID))
	(princ (sprintf "\n\tPARAM,NAME=ID,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0)))file) ; comes from program ýd
	(princ (sprintf "\n\tPARAM,NAME=GID,VALUE=\"G1001.~s\"" (_ (lmm_convertNumtoStringWithDigit CIXGEOMETRYID 0))) file) ; comes from geometri id
	(princ "\n\tPARAM,NAME=SIL,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=Z,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=DP,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempDepth 2))) file) ;depth
	(princ "\n\tPARAM,NAME=DIA,VALUE=0" file)
	(princ "\n\tPARAM,NAME=THR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=RV,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=CRC,VALUE=~s" (_ toolCorrection)) file) ; tool correction left of the line 2 , right of the line 1
	(princ "\n\tPARAM,NAME=CKA,VALUE=3" file)
	(princ "\n\tPARAM,NAME=AZ,VALUE=0" file)
	(princ "\n\tPARAM,NAME=AR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=OPT,VALUE=1" file)
	(princ (sprintf "\n\tPARAM,NAME=RSP,VALUE=~s" (_ (nth 9 tempCAMStyle))) file) ;spindle rpm
	(princ "\n\tPARAM,NAME=IOS,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=WSP,VALUE=~s" (_ (nth 10 tempCAMStyle))) file)
	(princ "\n\tPARAM,NAME=DSP,VALUE=5000" file)
	(princ "\n\tPARAM,NAME=IMS,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=VTR,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit (nth 3 tempCAMStyle) 0)) ) file)
	(princ "\n\tPARAM,NAME=DVR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=INCSTP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=OTR,VALUE=1" file)
	(princ "\n\tPARAM,NAME=SVR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=COF,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DOF,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=CIN,VALUE=1" file)
	(princ "\n\tPARAM,NAME=AIN,VALUE=90" file)
	(princ "\n\tPARAM,NAME=GIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TLI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TQI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TBI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=COU,VALUE=1" file)
	(princ "\n\tPARAM,NAME=AOU,VALUE=90" file)
	(princ "\n\tPARAM,NAME=GOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TBO,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TLO,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TQO,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=PRP,VALUE=100" file)
	(princ "\n\tPARAM,NAME=SDS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SDSF,VALUE=2000" file)
	(princ "\n\tPARAM,NAME=UDT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TDT,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=DDT,VALUE=5" file)
	(princ "\n\tPARAM,NAME=SDT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=IDT,VALUE=20" file)
	(princ "\n\tPARAM,NAME=FDT,VALUE=80" file)
	(princ "\n\tPARAM,NAME=RDT,VALUE=60" file)
	(princ "\n\tPARAM,NAME=CRR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=GIP,VALUE=1" file)
	(princ "\n\tPARAM,NAME=OVM,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SWI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=BLW,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TOS,VALUE=1" file)
	(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ tempToolName)) file) ; comes from tools name
	(princ "\n\tPARAM,NAME=TTP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=BFC,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SHP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=PRS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=NEBS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ETB,VALUE=0" file)
	(princ "\n\tPARAM,NAME=FXD,VALUE=0" file)
	(princ "\n\tPARAM,NAME=FXDA,VALUE=0" file)
	(princ "\n\tPARAM,NAME=KDT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=EML,VALUE=0" file)
	(princ "\n\tPARAM,NAME=CKT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ETG,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ETGT,VALUE=0.1" file)
	(princ "\n\tPARAM,NAME=AJT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ION,VALUE=0" file)
	(princ "\n\tPARAM,NAME=LUBMNZ,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SHT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SHD,VALUE=0" file)
	(princ "\n\tPARAM,NAME=LPR,VALUE=1" file)
	(princ "\n\tPARAM,NAME=LNG,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ZS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ZE,VALUE=0" file)
	(princ "\n\tPARAM,NAME=RDIN,VALUE=0" file)
	(princ "\nEND MACRO" file)
	(princ "\n\n\nBEGIN MACRO" cixFile)
	(princ "\n\tNAME=ENDPATH" cixFile)
	(princ "\nEND MACRO" cixFile)
)


(setq cixBiesse_ContourCAMOperation_v2 nil)
(defun cixBiesse_ContourCAMOperation_v2 (currentEnt entLayerName tempCAMStyle currentPanel file / tempDepth tempToolName toolCorrection entityToDraw
																								  bottomZComponent topZComponent stepOfPasses stepZComponets currentZLevel 
																					tempPoints	deleteHelper tempPoint firstPoint secondPoint firstSecondNormal fieldPoint pointIndex )
	(setq tempDepth (lmm_getLMMdata currentEnt lmm-k-depth))
	(setq tempDepth (+ tempDepth (nth 6 tempCAMStyle)))
	(setq tempToolName (cadr tempCAMStyle))
	
	;To define toolCorrection final result must be switch . Because Biesse Y coordinate values are inverted. 
	;info: GetIrregularPointlistClockwiseOrder adds extra closest point for a single line to determine clock order. 
	(setq toolCorrection "0") ; tool correction herzaman merkezde olacak çünkü takýmýn kaydýrýlmasý biz yapýyoruz.
	(setq deleteHelper nil)
	(cond
		( (equal "CENTER" (nth 7 tempCAMStyle)) 
			(setq entityToDraw currentEnt)
		)		
		( (equal "INSIDE" (nth 7 tempCAMStyle))
			(setq tempPoints (lmm_getPolylinePoints currentEnt))
			(setq firstPoint (nth 0 tempPoints))
			(setq secondPoint (nth 1 tempPoints))
			(setq firstSecondNormal (normalizeVector (VectorSub secondPoint firstPoint)))
			(if (equal "CCW" (GetIrregularPointlistClockwiseOrder_2 tempPoints currentPanel (nth 11 tempCAMStyle)))
				(setq firstSecondNormal (VectorRotate firstSecondNormal 1))
				(setq firstSecondNormal (VectorRotate firstSecondNormal -1))
			)
			(setq fieldPoint (VectorAdd firstPoint firstSecondNormal))
			(OFFSET (nth 8 tempCAMStyle) (list currentEnt firstPoint) fieldPoint)
			(setq entityToDraw (entlast))
			(setq deleteHelper T)
		)
		( (equal "OUTSIDE" (nth 7 tempCAMStyle))
			(setq tempPoints (lmm_getPolylinePoints currentEnt))
			(setq firstPoint (nth 0 tempPoints))
			(setq secondPoint (nth 1 tempPoints))
			(setq firstSecondNormal (normalizeVector (VectorSub secondPoint firstPoint)))
			(if (equal "CCW" (GetIrregularPointlistClockwiseOrder_2 tempPoints currentPanel (nth 11 tempCAMStyle)))
				(setq firstSecondNormal (VectorRotate firstSecondNormal -1))
				(setq firstSecondNormal (VectorRotate firstSecondNormal 1))
			)
			(setq fieldPoint (VectorAdd firstPoint firstSecondNormal))
			(OFFSET (nth 8 tempCAMStyle) (list currentEnt firstPoint) fieldPoint)
			(setq entityToDraw (entlast))
			(setq deleteHelper T)
		)
	)
	
	(drawCixGeometry currentPanel entityToDraw file)
	(if deleteHelper (deleteEntity (entlast)))
	
	(princ "\n\nBEGIN MACRO" file)
	(princ "\n\tNAME=ROUTG" file)
	(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" file)
	(setq CIXPROGRAMID (1+ CIXPROGRAMID))
	(princ (sprintf "\n\tPARAM,NAME=ID,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0)))file) ; comes from program ýd
	(princ (sprintf "\n\tPARAM,NAME=GID,VALUE=\"G1001.~s\"" (_ (lmm_convertNumtoStringWithDigit CIXGEOMETRYID 0))) file) ; comes from geometri id
	(princ "\n\tPARAM,NAME=SIL,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=Z,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=DP,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempDepth 2))) file) ;depth
	(princ "\n\tPARAM,NAME=DIA,VALUE=0" file)
	(princ "\n\tPARAM,NAME=THR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=RV,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=CRC,VALUE=~s" (_ toolCorrection)) file) ; tool correction left of the line 2 , right of the line 1
	(princ "\n\tPARAM,NAME=CKA,VALUE=3" file)
	(princ "\n\tPARAM,NAME=AZ,VALUE=0" file)
	(princ "\n\tPARAM,NAME=AR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=OPT,VALUE=1" file)
	(princ (sprintf "\n\tPARAM,NAME=RSP,VALUE=~s" (_ (nth 9 tempCAMStyle))) file) ;spindle rpm
	(princ "\n\tPARAM,NAME=IOS,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=WSP,VALUE=~s" (_ (nth 10 tempCAMStyle))) file)
	(princ "\n\tPARAM,NAME=DSP,VALUE=5000" file)
	(princ "\n\tPARAM,NAME=IMS,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=VTR,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit (nth 3 tempCAMStyle) 0)) ) file)
	(princ "\n\tPARAM,NAME=DVR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=INCSTP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=OTR,VALUE=1" file)
	(princ "\n\tPARAM,NAME=SVR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=COF,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DOF,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=CIN,VALUE=1" file)
	(princ "\n\tPARAM,NAME=AIN,VALUE=90" file)
	(princ "\n\tPARAM,NAME=GIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TLI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TQI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TBI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=COU,VALUE=1" file)
	(princ "\n\tPARAM,NAME=AOU,VALUE=90" file)
	(princ "\n\tPARAM,NAME=GOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TBO,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TLO,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TQO,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=PRP,VALUE=100" file)
	(princ "\n\tPARAM,NAME=SDS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SDSF,VALUE=2000" file)
	(princ "\n\tPARAM,NAME=UDT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TDT,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=DDT,VALUE=5" file)
	(princ "\n\tPARAM,NAME=SDT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=IDT,VALUE=20" file)
	(princ "\n\tPARAM,NAME=FDT,VALUE=80" file)
	(princ "\n\tPARAM,NAME=RDT,VALUE=60" file)
	(princ "\n\tPARAM,NAME=CRR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=GIP,VALUE=1" file)
	(princ "\n\tPARAM,NAME=OVM,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SWI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=BLW,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TOS,VALUE=1" file)
	(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ tempToolName)) file) ; comes from tools name
	(princ "\n\tPARAM,NAME=TTP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=BFC,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SHP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=PRS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=NEBS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ETB,VALUE=0" file)
	(princ "\n\tPARAM,NAME=FXD,VALUE=0" file)
	(princ "\n\tPARAM,NAME=FXDA,VALUE=0" file)
	(princ "\n\tPARAM,NAME=KDT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=EML,VALUE=0" file)
	(princ "\n\tPARAM,NAME=CKT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ETG,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ETGT,VALUE=0.1" file)
	(princ "\n\tPARAM,NAME=AJT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ION,VALUE=0" file)
	(princ "\n\tPARAM,NAME=LUBMNZ,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SHT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SHD,VALUE=0" file)
	(princ "\n\tPARAM,NAME=LPR,VALUE=1" file)
	(princ "\n\tPARAM,NAME=LNG,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ZS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ZE,VALUE=0" file)
	(princ "\n\tPARAM,NAME=RDIN,VALUE=0" file)
	(princ "\nEND MACRO" file)
	(princ "\n\n\nBEGIN MACRO" cixFile)
	(princ "\n\tNAME=ENDPATH" cixFile)
	(princ "\nEND MACRO" cixFile)
)

(defun cixBiesse_ContourCAMOperation_v3 (currentEnt entLayerName tempCAMStyle currentPanel file / tempDepth tempToolName toolCorrection entityToDraw
																								  bottomZComponent topZComponent stepOfPasses stepZComponets currentZLevel 
																					tempPoints	deleteHelper tempPoint firstPoint secondPoint firstSecondNormal fieldPoint pointIndex tempToolDia)
	(setq tempDepth (lmm_getLMMdata currentEnt lmm-k-depth))
	(setq tempDepth (+ tempDepth (nth 6 tempCAMStyle)))
	(setq tempToolName (cadr tempCAMStyle))
	(setq tempToolDia (* 2 (nth 8 tempCAMStyle)))
	
	;To define toolCorrection final result must be switch . Because Biesse Y coordinate values are inverted. 
	;info: GetIrregularPointlistClockwiseOrder adds extra closest point for a single line to determine clock order. 
	(setq toolCorrection "0") ; tool correction herzaman merkezde olacak çünkü takýmýn kaydýrýlmasý biz yapýyoruz.
	(setq deleteHelper nil)
	(cond
		( (equal "CENTER" (nth 7 tempCAMStyle)) 
			(setq entityToDraw currentEnt)
		)		
		( (equal "INSIDE" (nth 7 tempCAMStyle))
			(setq tempPoints (lmm_getPolylinePoints currentEnt))
			(setq firstPoint (nth 0 tempPoints))
			(setq secondPoint (nth 1 tempPoints))
			(setq firstSecondNormal (normalizeVector (VectorSub secondPoint firstPoint)))
			(if (equal "CCW" (GetIrregularPointlistClockwiseOrder_2 tempPoints currentPanel (nth 11 tempCAMStyle)))
				(setq firstSecondNormal (VectorRotate firstSecondNormal 1))
				(setq firstSecondNormal (VectorRotate firstSecondNormal -1))
			)
			(setq fieldPoint (VectorAdd firstPoint firstSecondNormal))
			(OFFSET (nth 8 tempCAMStyle) (list currentEnt firstPoint) fieldPoint)
			(setq entityToDraw (entlast))
			(setq deleteHelper T)
		)
		( (equal "OUTSIDE" (nth 7 tempCAMStyle))
			(setq tempPoints (lmm_getPolylinePoints currentEnt))
			(setq firstPoint (nth 0 tempPoints))
			(setq secondPoint (nth 1 tempPoints))
			(setq firstSecondNormal (normalizeVector (VectorSub secondPoint firstPoint)))
			(if (equal "CCW" (GetIrregularPointlistClockwiseOrder_2 tempPoints currentPanel (nth 11 tempCAMStyle)))
				(setq firstSecondNormal (VectorRotate firstSecondNormal -1))
				(setq firstSecondNormal (VectorRotate firstSecondNormal 1))
			)
			(setq fieldPoint (VectorAdd firstPoint firstSecondNormal))
			(OFFSET (nth 8 tempCAMStyle) (list currentEnt firstPoint) fieldPoint)
			(setq entityToDraw (entlast))
			(setq deleteHelper T)
		)
	)
	
	
	;(princ "\n\tPARAM,NAME=IMS,VALUE=0" file)
	;(princ "\n\tPARAM,NAME=INCSTP,VALUE=0" file)
	;(princ "\n\tPARAM,NAME=SDSF,VALUE=2000" file)
	;(princ "\n\tPARAM,NAME=ETGT,VALUE=0.1" file)
	;(princ "\n\tPARAM,NAME=AJT,VALUE=0" file)
	;(princ "\n\tPARAM,NAME=ION,VALUE=0" file)
	;(princ "\n\tPARAM,NAME=LUBMNZ,VALUE=0" file)
	;(princ "\n\tPARAM,NAME=SHT,VALUE=0" file)
	;(princ "\n\tPARAM,NAME=SHD,VALUE=0" file)
	;(princ "\n\tPARAM,NAME=LPR,VALUE=1" file)
	;(princ "\n\tPARAM,NAME=LNG,VALUE=0" file)
	;(princ "\n\tPARAM,NAME=RDIN,VALUE=0" file)
	; (princ "\n\n\nBEGIN MACRO" cixFile)
	; (princ "\n\tNAME=ENDPATH" cixFile)
	; (princ "\nEND MACRO" cixFile)
	
	(princ "\n\nBEGIN MACRO" file)
	(princ "\n\tNAME=ROUT" file)
	(princ (sprintf "\n\tPARAM,NAME=ID,VALUE=\"P~s\"" (_ (lmm_convertNumtoStringWithDigit CIXPROGRAMID 0)))file) ; comes from program ýd
	(princ "\n\tPARAM,NAME=SIDE,VALUE=0" file)
	(princ "\n\tPARAM,NAME=CRN,VALUE=\"1\"" file)
	(princ "\n\tPARAM,NAME=Z,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=DP,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempDepth 2))) file) ;depth
	(princ "\n\tPARAM,NAME=ISO,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=OPT,VALUE=YES" file)
	(princ (sprintf "\n\tPARAM,NAME=DIA,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempToolDia 2))) file)
	(princ "\n\tPARAM,NAME=RTY,VALUE=rpY" file)
	(princ "\n\tPARAM,NAME=XRC,VALUE=0" file)
	(princ "\n\tPARAM,NAME=YRC,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DX,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DY,VALUE=0" file)
	(princ "\n\tPARAM,NAME=R,VALUE=0" file)
	(princ "\n\tPARAM,NAME=A,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DA,VALUE=0" file)
	(princ "\n\tPARAM,NAME=RDL,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=NRP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=AZ,VALUE=0" file)
	(princ "\n\tPARAM,NAME=AR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ZS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ZE,VALUE=0" file)
	(princ "\n\tPARAM,NAME=CKA,VALUE=azrNO" file)
	(princ "\n\tPARAM,NAME=THR,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=RV,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=CKT,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=ARP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=LRP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=ER,VALUE=YES" file)
	(princ "\n\tPARAM,NAME=COW,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=OVM,VALUE=0" file)
	(princ "\n\tPARAM,NAME=A21,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TOS,VALUE=NO" file)
	(princ (sprintf "\n\tPARAM,NAME=VTR,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit (nth 3 tempCAMStyle) 0)) ) file)
	(princ "\n\tPARAM,NAME=DVR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=OTR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SVR,VALUE=0" file)
	(princ "\n\tPARAM,NAME=COF,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=DOF,VALUE=0" file)
	(princ "\n\tPARAM,NAME=GIP,VALUE=YES" file)
	(princ "\n\tPARAM,NAME=LSV,VALUE=0" file)
	(princ "\n\tPARAM,NAME=S21,VALUE=-1" file)
	(princ "\n\tPARAM,NAME=AZS,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=DSP,VALUE=~s" (_ (nth 10 tempCAMStyle))) file)
	(princ (sprintf "\n\tPARAM,NAME=RSP,VALUE=~s" (_ (nth 9 tempCAMStyle))) file) ;spindle rpm
	(princ "\n\tPARAM,NAME=IOS,VALUE=0" file)
	(princ (sprintf "\n\tPARAM,NAME=WSP,VALUE=~s" (_ (nth 10 tempCAMStyle))) file)
	(princ (sprintf "\n\tPARAM,NAME=TNM,VALUE=\"~s\"" (_ tempToolName)) file) ; comes from tools name
	(princ "\n\tPARAM,NAME=TTP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TCL,VALUE=1" file)
	(princ (sprintf "\n\tPARAM,NAME=CRC,VALUE=~s" (_ toolCorrection)) file) ; tool correction left of the line 2 , right of the line 1
	(princ "\n\tPARAM,NAME=TIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=AIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=CIN,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=GIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TBI,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=TLI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TQI,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=AOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=COU,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=GOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TBO,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=TLO,VALUE=0" file)
	(princ "\n\tPARAM,NAME=TQO,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=DOU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=SDS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=PRP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=BDR,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=SPI,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=SC,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=SWI,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=BLW,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=PRS,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=BFC,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=SHP,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=SWP,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=CSP,VALUE=0" file)
	(princ "\n\tPARAM,NAME=UDT,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=TDT,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=DDT,VALUE=5" file)
	(princ "\n\tPARAM,NAME=SDT,VALUE=0" file)
	(princ "\n\tPARAM,NAME=IDT,VALUE=20" file)
	(princ "\n\tPARAM,NAME=FDT,VALUE=80" file)
	(princ "\n\tPARAM,NAME=RDT,VALUE=60" file)
	(princ "\n\tPARAM,NAME=EA21,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=CEN,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=AGG,VALUE=\"\"" file)
	(princ "\n\tPARAM,NAME=LAY,VALUE=\"ROUT\"" file)
	(princ "\n\tPARAM,NAME=EECS,VALUE=0" file)
	(princ "\n\tPARAM,NAME=PDIN,VALUE=1" file)
	(princ "\n\tPARAM,NAME=PDU,VALUE=1" file)
	(princ "\n\tPARAM,NAME=PCIN,VALUE=0" file)
	(princ "\n\tPARAM,NAME=PCU,VALUE=0" file)
	(princ "\n\tPARAM,NAME=PMOL,VALUE=0" file)
	(princ "\n\tPARAM,NAME=AUX,VALUE=0" file)
	(princ "\n\tPARAM,NAME=CRR,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=NEBS,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=ETB,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=FXD,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=FXDA,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=KDT,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=EML,VALUE=NO" file)
	(princ "\n\tPARAM,NAME=ETG,VALUE=NO" file)
	(princ "\nEND MACRO" file)
	
	(drawCixROUTToolpath currentPanel entityToDraw file)
	(if deleteHelper (deleteEntity (entlast)))
)



(defun fillHeaderOfCixFile ( panel cixFile / tempPanelDepth tempPanelLength tempPanelWidth )
	(setq tempPanelDepth (lmm_getLMMdata panel lmm-k-depth))
	(setq tempPanelLength (getnth 2 (getBBox panel)))
	(setq tempPanelWidth (getnth 3 (getBBox panel)))
	(princ "\nBEGIN ID CID3" cixFile)
	(princ "\n	REL=5.0" cixFile)
	(princ "\nEND ID" cixFile)
	;Create Header
	(princ "\n\n\nBEGIN MAINDATA" cixFile)
	;(princ "\n\t'xml':<?xml version=\"1.0\" encoding=\"utf-8\" ?>" cixFile)
	;(princ "\n\t'xml':<!-- Created by bSolid -->" cixFile)
	;(princ "\n\t'xml':<bSolid>" cixFile)
	;(princ "\n\t'xml':	<Settings " cixFile)
	;(princ "\n\t'xml':		MultiPanelEnabled=\"0\"" cixFile)
	;(princ "\n\t'xml':		MultiPanelOrigin=\"1\"" cixFile)
	;(princ "\n\t'xml':	/>" cixFile)
	;(princ "\n\t'xml':	<Panel>" cixFile)
	;(princ "\n\t'xml':		<MachinePosition " cixFile)
	;(princ "\n\t'xml':			EXORIGIN=\"1\"" cixFile)
	;(princ "\n\t'xml':			EXREFCORNER=\"1\"" cixFile)
	;(princ "\n\t'xml':			EXOFFSETX=\"0\"" cixFile)
	;(princ "\n\t'xml':			EXOFFSETY=\"0\"" cixFile)
	;(princ "\n\t'xml':			EXOFFSETZ=\"0\"" cixFile)
	;(princ "\n\t'xml':			EXROTX=\"0\"" cixFile)
	;(princ "\n\t'xml':			EXROTY=\"0\"" cixFile)
	;(princ "\n\t'xml':			EXROTZ=\"0\"" cixFile)
	;(princ "\n\t'xml':			EXMIRRORX=\"0\"" cixFile)
	;(princ "\n\t'xml':			EXMIRRORY=\"0\"" cixFile)
	;(princ "\n\t'xml':		/>" cixFile)
	;(princ "\n\t'xml':	</Panel>" cixFile)
	;(princ "\n\t'xml':</bSolid>" cixFile)
	(princ "" cixFile)
	(princ (sprintf "\n\tLPX=~s" (_ (lmm_convertNumtoStringWithDigit tempPanelLength 3))) cixFile)
	(princ (sprintf "\n\tLPY=~s" (_ (lmm_convertNumtoStringWithDigit tempPanelWidth 3))) cixFile)
	(princ (sprintf "\n\tLPZ=~s" (_ (lmm_convertNumtoStringWithDigit tempPanelDepth 3))) cixFile)
	(princ "\n\tORLST=\"5\"" cixFile)
	(princ "\n\tSIMMETRY=0" cixFile)
	(princ "\n\tTLCHK=0" cixFile)
	(princ "\n\tTOOLING=\"\"" cixFile)
	(princ "\n\tCUSTSTR=\"\"" cixFile)
	(princ "\n\tFCN=1" cixFile)
	(princ "\n\tXCUT=0" cixFile)
	(princ "\n\tYCUT=0" cixFile)
	(princ "\n\tJIGTH=0" cixFile)
	(princ "\n\tCKOP=0" cixFile)
	(princ "\n\tUNIQUE=0" cixFile)
	(princ "\n\tMATERIAL=\"Wood\"" cixFile)
	(princ "\n\tPUTLST=\"\"" cixFile)
	(princ "\n\tOPPWKRS=0" cixFile)
	(princ "\n\tUNICLAMP=0" cixFile)
	(princ "\n\tWTPIANI=0" cixFile)
	(princ "\n\tCOLLTOOL=0" cixFile)
	(princ "\n\tCALCEDTH=0" cixFile)
	(princ "\n\tENABLELABEL=0" cixFile)
	(princ "\n\tLOCKWASTE=0" cixFile)
	(princ "\n\tLOADEDGEOPT=0" cixFile)
	(princ "\n\tITLTYPE=0" cixFile)
	(princ "\n\tRUNPAV=0" cixFile)
	(princ "\n\tFLIPEND=0" cixFile)
	(princ "\n\tENABLEMACHLINKS=0" cixFile)
	(princ "\n\tENABLEPURSUITS=0" cixFile)
	(princ "\n\tENABLEFASTVERTBORINGS=0" cixFile)
	(princ "\n\tFASTVERTBORINGSVALUE=0" cixFile)
	(princ "\nEND MAINDATA" cixFile)
	(princ "\n\n\nBEGIN PUBLICVARS" cixFile)
	(princ "\nEND PUBLICVARS" cixFile)
	
	;(princ "\n\nBEGIN MACRO" cixFile)
	;(princ "\n\tNAME=GEO" cixFile)
	;(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" cixFile)
	;(setq CIXGEOMETRYID (1+ CIXGEOMETRYID))
	;(princ (sprintf "\n\tPARAM,NAME=ID,VALUE=\"G1001.~s\"" (_  (lmm_convertNumtoStringWithDigit CIXGEOMETRYID 0))) cixFile)
	;(princ "\n\tPARAM,NAME=SIDE,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=CRN,VALUE=\"2\"" cixFile)
	;(princ "\n\tPARAM,NAME=DP,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=RTY,VALUE=2" cixFile)
	;(princ "\n\tPARAM,NAME=NRP,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=DX,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=DY,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=RV,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=COW,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=CRC,VALUE=0" cixFile)
	;(princ "\nEND MACRO" cixFile)
	;
	;(princ "\n\nBEGIN MACRO" cixFile)
	;(princ "\n\tNAME=START_POINT" cixFile)
	;(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" cixFile)
	;(princ "\n\tPARAM,NAME=X,VALUE=0" cixFile)
	;;(princ (sprintf "\n\tPARAM,NAME=Y,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempPanelWidth 3))) cixFile)
	;(princ (sprintf "\n\tPARAM,NAME=Y,VALUE=~s" (_ "0")) cixFile)
	;(princ "\nEND MACRO" cixFile)
	;
	;(princ "\n\nBEGIN MACRO" cixFile)
	;(princ "\n\tNAME=LINE_EP" cixFile)
	;(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" cixFile)
	;(princ "\n\tPARAM,NAME=ID,VALUE=100" cixFile)
	;(princ "\n\tPARAM,NAME=XE,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=YE,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=ZS,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=ZE,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=FD,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=SP,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=MVT,VALUE=0" cixFile)
	;(princ "\nEND MACRO" cixFile)
	;
	;(princ "\n\nBEGIN MACRO" cixFile)
	;(princ "\n\tNAME=LINE_EP" cixFile)
	;(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" cixFile)
	;(princ "\n\tPARAM,NAME=ID,VALUE=101" cixFile)
	;(princ (sprintf  "\n\tPARAM,NAME=XE,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempPanelLength 3))) cixFile)
	;(princ "\n\tPARAM,NAME=YE,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=ZS,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=ZE,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=FD,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=SP,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=MVT,VALUE=0" cixFile)
	;(princ "\nEND MACRO" cixFile)
	;
	;(princ "\n\nBEGIN MACRO" cixFile)
	;(princ "\n\tNAME=LINE_EP" cixFile)
	;(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" cixFile)
	;(princ "\n\tPARAM,NAME=ID,VALUE=102" cixFile)
	;(princ (sprintf  "\n\tPARAM,NAME=XE,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempPanelLength 3))) cixFile)
	;(princ (sprintf  "\n\tPARAM,NAME=YE,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempPanelWidth 3))) cixFile)
	;(princ "\n\tPARAM,NAME=ZS,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=ZE,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=FD,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=SP,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=MVT,VALUE=0" cixFile)
	;(princ "\nEND MACRO" cixFile)
	;
	;(princ "\n\nBEGIN MACRO" cixFile)
	;(princ "\n\tNAME=LINE_EP" cixFile)
	;(princ "\n\tPARAM,NAME=LAY,VALUE=\"Layer 0\"" cixFile)
	;(princ "\n\tPARAM,NAME=ID,VALUE=103" cixFile)
	;(princ "\n\tPARAM,NAME=XE,VALUE=0" cixFile)
	;(princ (sprintf  "\n\tPARAM,NAME=YE,VALUE=~s" (_ (lmm_convertNumtoStringWithDigit tempPanelWidth 3))) cixFile)
	;(princ "\n\tPARAM,NAME=ZS,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=ZE,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=FD,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=SP,VALUE=0" cixFile)
	;(princ "\n\tPARAM,NAME=MVT,VALUE=0" cixFile)
	;(princ "\nEND MACRO" cixFile)
	;(fillEndOfCixFile cixFile)
	
)

(defun fillEndOfCixFile ( cixFile / )
	(princ "\n\n\nBEGIN MACRO" cixFile)
	(princ "\n\tNAME=ENDPATH" cixFile)
	(princ "\nEND MACRO" cixFile)
)


(setq sendBiesseMachine nil)
(defun sendBiesseMachine (cPnl machineProcedures / cixFilesPath tempPanelName tempPanelDepth 
													tempPanelLength tempPanelWidth cixFile 
													currentOp tempOpLayerName tempOpOpName tempPanelSS tempPanelSSList 
													tempEnt tempDerivedLayerName )
	(setq CIXPROGRAMID 1000)
	(setq CIXGEOMETRYID 1000)
	(setq cixFilesPath (strcat (lmm_prepareOutDirs) "\\"))
	(setq tempPanelName (lmm_getLMMdata cPnl lmm-k-customCode))
	(setq tempPanelDepth (lmm_getLMMdata cPnl lmm-k-depth))
	(setq tempPanelLength (getnth 2 (getBBox cPnl)))
	(setq tempPanelWidth (getnth 3 (getBBox cPnl)))
	(createDir (strcat cixFilesPath))
	(setq cixFile (open (strcat cixFilesPath (lmm_getDXFFileNameByFileMode (list cPnl)) ".cix") "w"))
	(fillHeaderOfCixFile cPnl cixFile)
	
	(foreach currentOp machineProcedures
		(setq tempOpLayerName (nth 0 currentOp))
		(setq tempOpOpName (nth 2 currentOp))
		(setq tempPanelSS (lmm_getComponentWithChild cPnl "ALL"))
		(setq tempPanelSSList (convertSStolist tempPanelSS))
		(setq tempPanelSSList (entOptimization tempPanelSSList))
		(foreach tempEnt tempPanelSSList
			
			(if (equal (lmm_getLMMdata tempEnt lmm-k-type) "HOLE") ; delikler geometrisine göre yorumlanýyor geçici bir layer ismi belirleniyor
				(progn 
					(setq tempDerivedLayerName (cixInterpretHoleLayerName tempEnt))
				)
				(progn 
					(setq tempDerivedLayerName (getentpro  tempEnt 8 ))
				)
			)
			
			
			(if (not (member tempDerivedLayerName cixIgnoreLayerNameList))
				(if  (not (member (strcat tempPanelName "->"  tempDerivedLayerName) cixAllEntities))
					(setq cixAllEntities (append cixAllEntities (list (strcat tempPanelName "->"  tempDerivedLayerName))))
				)
			)
			
			
			(if (equal tempDerivedLayerName tempOpLayerName) ;; cam yapýlmasý gereken etity
				(progn
					(cond 
						((equal tempOpOpName "HOLE") 
							(cixBiesse_HoleCamOperation tempEnt tempDerivedLayerName currentOp cPnl cixFile)
							(setq cixNotFreeEntities (append cixNotFreeEntities (list (strcat tempPanelName "->" tempDerivedLayerName))))
						) 
						((equal tempOpOpName "SAW") ;testere iþlemi
							(cixBiesse_SAWCAMOperation tempEnt tempDerivedLayerName currentOp cPnl cixFile)
							(setq cixNotFreeEntities (append cixNotFreeEntities (list (strcat tempPanelName "->" tempDerivedLayerName))))
						)
						((equal tempOpOpName "CONTOUR") ;freze iþlemi
							(cixBiesse_ContourCAMOperation tempEnt tempDerivedLayerName currentOp cPnl cixFile)
							(setq cixNotFreeEntities (append cixNotFreeEntities (list (strcat tempPanelName "->" tempDerivedLayerName))))
						)
						((equal tempOpOpName "CONTOUR_V2") ;freze iþlemi, ama takým kaydýrma iþini biz yapyoruz takým hep merkezden gidiyor.
							(cixBiesse_ContourCAMOperation_v2 tempEnt tempDerivedLayerName currentOp cPnl cixFile)
							(setq cixNotFreeEntities (append cixNotFreeEntities (list (strcat tempPanelName "->" tempDerivedLayerName))))
						)
						((equal tempOpOpName "CONTOUR_V3") ;freze iþlemi, ama takým kaydýrma iþini biz yapyoruz takým hep merkezden gidiyor.
							(cixBiesse_ContourCAMOperation_v3 tempEnt tempDerivedLayerName currentOp cPnl cixFile)
							(setq cixNotFreeEntities (append cixNotFreeEntities (list (strcat tempPanelName "->" tempDerivedLayerName))))
						)
					)
				)
			)
			
		)
	)

	;(fillEndOfCixFile cixFile)
	(close cixFile)
)

(princ)
